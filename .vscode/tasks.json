{
  // See https://go.microsoft.com/fwlink/?LinkId=733558
  // Schema: https://code.visualstudio.com/docs/reference/tasks-appendix
  "$schema": "vscode://schemas/tasks",
  "version": "2.0.0",
  "inputs": [
    {
      "id": "perfFilter",
      "description": "Performance benchmark wildcard filter (e.g., *Sma* or *ToEma*)",
      "default": "*Sma*",
      "type": "promptString"
    },
    {
      "id": "roslynatorCommand",
      "description": "Select command type for Roslynator",
      "options": [
        "analyze",
        "fix"
      ],
      "default": "fix",
      "type": "pickString"
    },
    {
      "id": "roslynatorSeverity",
      "description": "Select severity level (depth) for Roslynator action",
      "options": [
        "error",
        "warning",
        "info",
        "hidden"
      ],
      "default": "info",
      "type": "pickString"
    },
    {
      "id": "simulationMode",
      "description": "Select simulation mode (data source)",
      "options": [
        "sse",
        "coinbase"
      ],
      "default": "sse",
      "type": "pickString"
    },
    {
      "id": "dataType",
      "description": "Data type: quote (candles/klines) or trade (ticker/transactions)",
      "options": [
        "quote",
        "trade"
      ],
      "default": "quote",
      "type": "pickString"
    },
    {
      "id": "deliveryInterval",
      "description": "Delivery rate in milliseconds (how fast data is sent)",
      "default": "50",
      "type": "promptString"
    },
    {
      "id": "count",
      "description": "Maximum count (leave empty for unlimited)",
      "default": "",
      "type": "promptString"
    },
    {
      "id": "quoteInterval",
      "description": "Quote interval / timestamp spacing (e.g., 1s, 1m, 5m, 1h, 1d)",
      "default": "1m",
      "type": "promptString"
    },
    {
      "id": "coinbaseSymbol",
      "description": "Coinbase trading pair (e.g., BTC-USD, ETH-USD)",
      "default": "BTC-USD",
      "type": "promptString"
    }
  ],
  // defaults
  "group": "none",
  "presentation": {
    "clear": true,
    "echo": true,
    "panel": "dedicated",
    "focus": true,
    "reveal": "always",
    "revealProblems": "onProblem",
    "showReuseMessage": false
  },
  "problemMatcher": [],
  "options": {
    "cwd": "${workspaceFolder}"
  },
  // tasks
  "tasks": [
    {
      "label": "Setup: Dev tools",
      "detail": "Complete one-time environment setup (global tools and packages)",
      "type": "shell",
      "command": "bash .devcontainer/startup.sh",
      "problemMatcher": [
        "$msCompile",
        "$eslint-compact"
      ]
    },
    {
      "label": "Initialize: Pull, rebuild, fixers, and unit test",
      "detail": "Pull latest, clean, rebuild non-incremental, fix all, and test",
      "group": "build",
      "dependsOn": [
        "Git: pull",
        "Clean: .NET Solution (dotnet clean)",
        "Build: .NET Solution (not incremental)",
        "Lint: .NET code & markdown files (fix)",
        "Test: Unit tests"
      ],
      "dependsOrder": "sequence"
    },
    {
      "label": "Git: pull",
      "detail": "Pull latest changes from Git",
      "type": "shell",
      "command": "git pull || echo 'No remote branch!'",
      "problemMatcher": []
    },
    {
      "label": "Install: All code dependencies",
      "detail": "Restore .NET and NPM packages",
      "dependsOn": [
        "Install: .NET packages",
        "Install: NPM (pnpm) packages"
      ],
      "dependsOrder": "parallel"
    },
    {
      "label": "Install: .NET packages",
      "detail": "Restore NuGet packages for solution",
      "type": "shell",
      "command": "dotnet restore && dotnet restore docs/Examples && dotnet outdated --exclude FluentAssertions",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Install: Chrome for Puppeteer",
      "detail": "Install Chrome browser for Puppeteer-based accessibility testing",
      "type": "shell",
      "command": "pnpm dlx puppeteer browsers install chrome",
      "presentation": {
        "echo": false,
        "clear": true,
        "panel": "shared"
      }
    },
    {
      "label": "Inspect: .NET packages",
      "detail": "List outdated NuGet packages in the root solution using dotnet-outdated",
      "type": "shell",
      "command": "dotnet outdated --exclude FluentAssertions && dotnet outdated docs/Examples"
    },
    {
      "label": "Update: .NET packages (outdated --upgrade)",
      "detail": "Upgrade outdated NuGet packages in the root solution using dotnet-outdated",
      "type": "shell",
      "command": "dotnet outdated --upgrade --exclude FluentAssertions && dotnet outdated --upgrade docs/Examples"
    },
    {
      "label": "Install: NPM (pnpm) packages",
      "detail": "Install pnpm packages for website (VitePress)",
      "type": "shell",
      "command": "pnpm install",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      },
      "problemMatcher": []
    },
    {
      "label": "Update: NPM (pnpm) packages",
      "detail": "Update pnpm packages for website",
      "type": "shell",
      "command": "pnpm update",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      }
    },
    {
      "label": "Clean: Website build cache",
      "detail": "Delete the dist build outputs cache.",
      "type": "shell",
      "command": "rm -rf dist",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      }
    },
    {
      "label": "Clean: .NET Solution (dotnet clean)",
      "detail": "Clean build outputs (bin/obj) for solution",
      "type": "shell",
      "command": "dotnet clean -v minimal --nologo && dotnet clean -c Release -v minimal --nologo",
      "group": "build",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Delete: Temporary caches",
      "detail": "Delete bin, obj, node_modules, other caches, and lock files",
      "type": "shell",
      "command": "bash tools/scripts/clean.sh",
      "group": "build",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Delete: Temporary caches (and restore)",
      "detail": "Delete temporary caches then restore",
      "type": "shell",
      "command": "bash tools/scripts/clean.sh && dotnet restore --force-evaluate",
      "group": "build",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Delete: Temporary caches (and build)",
      "detail": "Delete temporary caches then rebuild",
      "type": "shell",
      "command": "bash tools/scripts/clean.sh && dotnet build --no-incremental",
      "group": "build",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Build: .NET Solution (incremental)",
      "detail": "Incremental build of solution (default)",
      "type": "shell",
      "command": "dotnet build -v minimal --nologo",
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Build: .NET Solution (not incremental)",
      "detail": "Full rebuild without incremental compilation",
      "type": "shell",
      "command": "dotnet build -v minimal --nologo --no-incremental",
      "group": "build",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Build: Website",
      "detail": "Build VitePress website for production",
      "type": "shell",
      "command": "pnpm run docs:build",
      "dependsOn": "Install: NPM (pnpm) packages",
      "dependsOrder": "sequence",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      }
    },
    {
      "label": "Lint: .NET format",
      "detail": "Verify code formatting and style with 'dotnet format'",
      "type": "shell",
      "command": "dotnet format --verify-no-changes --severity info --no-restore",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: .NET format (fix)",
      "detail": "Fix code formatting and style with 'dotnet format'",
      "type": "shell",
      "command": "dotnet format --severity info --no-restore",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: .NET Roslynator (custom)",
      "detail": "Input params for Roslynator action",
      "type": "shell",
      "command": "roslynator ${input:roslynatorCommand} --properties TargetFramework=net10.0 --severity-level ${input:roslynatorSeverity} --verbosity normal",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: .NET Roslynator (analyze)",
      "detail": "Verify code formatting and style with Roslynator",
      "type": "shell",
      "command": "roslynator analyze --properties TargetFramework=net10.0 --severity-level info --verbosity normal",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: .NET Roslynator (fix)",
      "detail": "Fix code formatting and style with Roslynator",
      "type": "shell",
      "command": "roslynator fix --properties TargetFramework=net10.0 --severity-level info --verbosity normal",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: .NET code",
      "detail": "Run Roslynator analysis only (fast for dev loop)",
      "dependsOn": [
        "Build: .NET Solution (incremental)",
        "Lint: .NET Roslynator (analyze)"
      ],
      "dependsOrder": "sequence",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: .NET code (fix)",
      "detail": "Auto-fix .NET code issues with Roslynator (fast for dev loop)",
      "dependsOn": [
        "Lint: .NET Roslynator (fix)"
      ],
      "dependsOrder": "sequence",
      "group": "none",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Lint: Markdown",
      "detail": "Run markdownlint over documentation",
      "type": "shell",
      "command": "echo y | npx markdownlint-cli2",
      "group": "test",
      "problemMatcher": "$markdownlint"
    },
    {
      "label": "Lint: Markdown (fix)",
      "detail": "Auto-fix markdown formatting issues",
      "type": "shell",
      "command": "echo y | npx markdownlint-cli2 --fix",
      "problemMatcher": "$markdownlint"
    },
    {
      "label": "Lint: .NET code & markdown files",
      "detail": "Run Roslynator analysis and markdown lint (fast for dev loop)",
      "dependsOn": [
        "Build: .NET Solution (incremental)",
        "Lint: .NET code",
        "Lint: Markdown"
      ],
      "dependsOrder": "sequence",
      "group": "test",
      "problemMatcher": [
        "$msCompile",
        "$markdownlint"
      ]
    },
    {
      "label": "Lint: .NET code & markdown files (fix)",
      "detail": "Auto-fix code and markdown issues with Roslynator (fast for dev loop)",
      "dependsOn": [
        "Lint: .NET code (fix)",
        "Lint: Markdown (fix)"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": [
        "$msCompile",
        "$markdownlint"
      ]
    },
    {
      "label": "Lint: All",
      "detail": "Run complete linting (Roslynator + dotnet format + markdown)",
      "dependsOn": [
        "Build: .NET Solution (incremental)",
        "Lint: .NET Roslynator (analyze)",
        "Lint: .NET format",
        "Lint: Markdown"
      ],
      "dependsOrder": "sequence",
      "group": "test",
      "problemMatcher": [
        "$msCompile",
        "$markdownlint"
      ]
    },
    {
      "label": "Lint: All (fix)",
      "detail": "Auto-fix all code and markdown issues (includes dotnet format)",
      "dependsOn": [
        "Lint: .NET Roslynator (fix)",
        "Lint: .NET format (fix)",
        "Lint: Markdown (fix)"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": [
        "$msCompile",
        "$markdownlint"
      ]
    },
    {
      "label": "Test: Unit tests",
      "detail": "Run unit tests only (excludes integration and regression tests)",
      "type": "shell",
      "command": "dotnet test tests/indicators/Tests.Indicators.csproj --no-restore --nologo --settings tests/tests.unit.runsettings",
      "group": {
        "kind": "test",
        "isDefault": true
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Regression tests",
      "detail": "Run regression tests only (baseline validation)",
      "type": "shell",
      "command": "dotnet test tests/indicators/Tests.Indicators.csproj --no-restore --nologo --settings tests/tests.regression.runsettings",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Integration",
      "detail": "Run integration tests only (requires external dependencies)",
      "type": "shell",
      "command": "dotnet test tests/integration/Tests.Integration.csproj --no-restore --nologo && dotnet test tests/public-api/Tests.PublicApi.csproj --no-restore --nologo",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: All tests",
      "detail": "Run all tests including integration tests",
      "type": "shell",
      "command": "dotnet test --no-restore --nologo",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Unit tests with coverage",
      "detail": "Run tests with coverage collection",
      "type": "shell",
      "command": "dotnet test --collect:\"Code Coverage\" --no-restore --nologo",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Performance (all)",
      "detail": "Run all BenchmarkDotNet performance tests (Release mode)",
      "type": "shell",
      "command": "dotnet run --project tools/performance/Tests.Performance.csproj -c Release",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Performance (Series)",
      "detail": "Run Series indicator benchmarks only (Release mode)",
      "type": "shell",
      "command": "dotnet run --project tools/performance/Tests.Performance.csproj -c Release -- --filter *SeriesIndicators*",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Performance (Buffer)",
      "detail": "Run Buffer indicator benchmarks only (Release mode)",
      "type": "shell",
      "command": "dotnet run --project tools/performance/Tests.Performance.csproj -c Release -- --filter *BufferIndicators*",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Performance (Stream)",
      "detail": "Run Stream indicator benchmarks only (Release mode)",
      "type": "shell",
      "command": "dotnet run --project tools/performance/Tests.Performance.csproj -c Release -- --filter *StreamIndicators*",
      "group": "test",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Performance (spot check)",
      "detail": "Quick indicator performance benchmark using filter pattern (e.g., *Sma* matches ToSma, SmaHub, SmaList)",
      "type": "shell",
      "command": "dotnet run --project Tests.Performance.csproj -c Release -- --filter \"${input:perfFilter}\" --job short --warmupCount 3 --iterationCount 5 --exporters json markdown",
      "options": {
        "cwd": "${workspaceFolder}/tools/performance"
      },
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Test: Website links (htmlproofer)",
      "detail": "Build docs and run htmlproofer link checks (parity with CI)",
      "type": "shell",
      "command": "bash .vitepress/run-htmlproofer.sh",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      },
      "dependsOn": "Start: Docker Desktop",
      "dependsOrder": "sequence"
    },
    {
      "label": "Test: Website a11y (pa11y)",
      "detail": "Build website, preview locally, and run pa11y-ci sitemap checks",
      "type": "shell",
      "command": "bash .vitepress/run-pa11y.sh",
      "options": {
        "cwd": "${workspaceFolder}/docs"
      },
      "dependsOn": "Install: Chrome for Puppeteer",
      "dependsOrder": "sequence"
    },
    {
      "label": "Verify: Quick checks (build + lint + unit test)",
      "detail": "Complete CI verification: build, lint, and test",
      "group": "test",
      "dependsOn": [
        "Build: .NET Solution (incremental)",
        "Lint: .NET code & markdown files",
        "Test: Unit tests"
      ],
      "dependsOrder": "sequence"
    },
    {
      "label": "Generate: Test baseline data (all)",
      "detail": "Generate all regression test baseline JSON files",
      "type": "shell",
      "command": "dotnet run --project tools/baselining/Test.DataGenerator.csproj -- --all",
      "group": "none",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Run: Website (dev server)",
      "detail": "Serve VitePress website with hot reload (port 5173)",
      "type": "shell",
      "command": "pnpm run docs:dev",
      "dependsOn": "Install: NPM (pnpm) packages",
      "dependsOrder": "sequence",
      "isBackground": true,
      "runOptions": {
        "instanceLimit": 1
      },
      "options": {
        "cwd": "${workspaceFolder}/docs"
      }
    },
    {
      "label": "Run: Website (Simple Browser)",
      "detail": "Serve VitePress website with hot reload on port 5174 (VS Code Simple Browser)",
      "type": "shell",
      "command": "pnpm run docs:dev -- --port 5174",
      "dependsOn": "Install: NPM (pnpm) packages",
      "dependsOrder": "sequence",
      "isBackground": true,
      "runOptions": {
        "instanceLimit": 1
      },
      "options": {
        "cwd": "${workspaceFolder}/docs"
      }
    },
    {
      "label": "Run: Website (prod preview)",
      "detail": "Preview production build of VitePress website",
      "type": "shell",
      "command": "pnpm run docs:preview -- --open",
      "dependsOn": "Build: Website",
      "isBackground": true,
      "options": {
        "cwd": "${workspaceFolder}/docs"
      }
    },
    {
      "label": "Run: Test application",
      "detail": "Run the test application tool (exercises all indicators)",
      "type": "shell",
      "command": "dotnet run --project tools/application/Test.Application.csproj",
      "group": "none",
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Run: Simulation with inputs",
      "detail": "Run simulation with configurable mode, data type, intervals, and count",
      "type": "shell",
      "command": "dotnet run --project tools/simulate/Test.Simulation.csproj -- ${input:simulationMode} ${input:dataType} ${input:deliveryInterval} \"${input:count}\" ${input:quoteInterval} ${input:coinbaseSymbol}",
      "group": "none",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^$"
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^Starting.*simulation",
          "endsPattern": "^Strategy complete|^Stream complete|^Client disconnected"
        }
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Run: Simulation (default SSE)",
      "detail": "Run SSE simulation with defaults: quote data, 50ms delivery, 1m intervals, unlimited count",
      "type": "shell",
      "command": "dotnet run --project tools/simulate/Test.Simulation.csproj -- sse quote 50 '' 1m",
      "windows": {
        "command": "dotnet run --project tools/simulate/Test.Simulation.csproj -- sse quote 50 \"\" 1m"
      },
      "group": "none",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^$"
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^Starting.*simulation",
          "endsPattern": "^Strategy complete|^Stream complete|^Client disconnected"
        }
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Run: SSE Server",
      "detail": "Start SSE server on localhost:5001",
      "type": "shell",
      "command": "dotnet run --project tools/sse-server/Test.SseServer.csproj -- --urls http://localhost:5001",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^$"
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^Building...|^SSE Server starting",
          "endsPattern": "^Now listening on:"
        }
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      }
    },
    {
      "label": "Show: Running servers",
      "detail": "Display all running VitePress, Simulation, and SSE Server processes",
      "type": "shell",
      "command": "echo '=== Running Servers ===' && echo '' && echo 'VitePress (node.exe):' && (tasklist //fi \"imagename eq node.exe\" 2>/dev/null | grep -E 'node|PID' || echo '   No processes found') && echo '' && echo 'Simulation/SSE Server (dotnet.exe):' && (tasklist //fi \"imagename eq dotnet.exe\" 2>/dev/null | grep -E 'dotnet|PID' || echo '   No processes found')",
      "linux": {
        "command": "echo '=== Running Servers ===' && echo '' && echo 'VitePress (node):' && (ps aux | grep -E '[n]ode.*vitepress|PID.*CMD' || echo '   No processes found') && echo '' && echo 'Simulation/SSE Server (dotnet):' && (ps aux | grep -E '[d]otnet.*(simulate|sse-server)|PID.*CMD' || echo '   No processes found')"
      },
      "osx": {
        "command": "echo '=== Running Servers ===' && echo '' && echo 'VitePress (node):' && (ps aux | grep -E '[n]ode.*vitepress|PID.*CMD' || echo '   No processes found') && echo '' && echo 'Simulation/SSE Server (dotnet):' && (ps aux | grep -E '[d]otnet.*(simulate|sse-server)|PID.*CMD' || echo '   No processes found')"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "clear": true
      }
    },
    {
      "label": "Stop: VitePress servers",
      "detail": "Stop VitePress dev/preview servers on default ports (5173/5174)",
      "type": "shell",
      "command": "netstat -ano 2>/dev/null | grep -E ':(5173|5174)\\\\s' | awk '{print $5}' | sort -u | xargs -I {} taskkill //PID {} //F 2>/dev/null && echo '[OK] VitePress servers successfully stopped' || echo '[INFO] No VitePress server processes found'",
      "linux": {
        "command": "(lsof -ti:5173,5174 2>/dev/null | xargs -r kill -9 2>/dev/null && echo '[OK] VitePress servers successfully stopped') || echo '[INFO] No VitePress server processes found'"
      },
      "osx": {
        "command": "(lsof -ti:5173,5174 2>/dev/null | xargs kill -9 2>/dev/null && echo '[OK] VitePress servers successfully stopped') || echo '[INFO] No VitePress server processes found'"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "clear": true
      }
    },
    {
      "label": "Stop: All hosted servers",
      "detail": "Stop all hosted servers: VitePress, Simulation, and SSE Server",
      "dependsOn": [
        "Stop: VitePress servers",
        "Stop: Simulation hosts",
        "Stop: SseServer hosts"
      ],
      "dependsOrder": "parallel",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Stop: Simulation hosts",
      "detail": "Stop dotnet processes running tools/simulate or Test.Simulation",
      "type": "shell",
      "command": "wmic process where \"name='dotnet.exe' and (commandline like '%Test.Simulation%' or commandline like '%tools/simulate%' or commandline like '%tools\\\\\\\\simulate%')\" get processid 2>/dev/null | grep -E '^[0-9]+' | xargs -I {} taskkill //PID {} //F 2>/dev/null && echo '[OK] Simulation hosts successfully stopped' || echo '[INFO] No Simulation server processes found'",
      "linux": {
        "command": "(pkill -9 -f 'dotnet.*(Test\\.Simulation|tools/simulate)' 2>/dev/null && echo '[OK] Simulation hosts successfully stopped') || echo '[INFO] No Simulation server processes found'"
      },
      "osx": {
        "command": "(pkill -9 -f 'dotnet.*(Test\\.Simulation|tools/simulate)' 2>/dev/null && echo '[OK] Simulation hosts successfully stopped') || echo '[INFO] No Simulation server processes found'"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "clear": true
      }
    },
    {
      "label": "Stop: SseServer hosts",
      "detail": "Stop dotnet/Test.SseServer processes running tools/sse-server or Test.SseServer.exe",
      "type": "shell",
      "command": "(netstat -ano 2>/dev/null | grep ':5001\\\\s' | awk '{print $5}' | sort -u | xargs -I {} taskkill //PID {} //F 2>/dev/null; wmic process where \"name='dotnet.exe' and (commandline like '%Test.SseServer%' or commandline like '%tools/sse-server%' or commandline like '%tools\\\\\\\\sse-server%')\" get processid 2>/dev/null | grep -E '^[0-9]+' | xargs -I {} taskkill //PID {} //F 2>/dev/null) && echo '[OK] SSE Server hosts successfully stopped' || echo '[INFO] No SSE Server server processes found'",
      "linux": {
        "command": "((lsof -ti:5001 2>/dev/null | xargs -r kill -9 2>/dev/null); (pkill -9 -f 'dotnet.*(Test\\.SseServer|tools/sse-server)' 2>/dev/null)) && echo '[OK] SSE Server hosts successfully stopped' || echo '[INFO] No SSE Server server processes found'"
      },
      "osx": {
        "command": "((lsof -ti:5001 2>/dev/null | xargs kill -9 2>/dev/null); (pkill -9 -f 'dotnet.*(Test\\.SseServer|tools/sse-server)' 2>/dev/null)) && echo '[OK] SSE Server hosts successfully stopped' || echo '[INFO] No SSE Server server processes found'"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "clear": true
      }
    },
    {
      "label": "Start: Docker Desktop",
      "detail": "Ensure Docker Desktop is running (waits for daemon to be ready)",
      "type": "shell",
      "command": "echo 'Checking Docker...' && (docker info > /dev/null 2>&1 && echo '✅ Docker is ready' || (echo 'Waiting for Docker...' && timeout=60 && elapsed=0 && until docker info > /dev/null 2>&1; do if [ $elapsed -ge $timeout ]; then echo '❌ Docker failed to start'; exit 1; fi; sleep 2; elapsed=$((elapsed + 2)); done && echo '✅ Docker is ready'))",
      "windows": {
        "command": "Write-Host 'Checking Docker...'; if (docker info 2>$null) { Write-Host '✅ Docker is ready' } else { Write-Host 'Waiting for Docker...'; $timeout = 60; $elapsed = 0; while (-not (docker info 2>$null)) { if ($elapsed -ge $timeout) { Write-Host '❌ Docker failed to start'; exit 1 }; Start-Sleep -Seconds 2; $elapsed += 2 }; Write-Host '✅ Docker is ready' }",
        "options": {
          "shell": {
            "executable": "powershell.exe",
            "args": [
              "-Command"
            ]
          }
        }
      },
      "linux": {
        "command": "echo 'Checking Docker...' && (docker info > /dev/null 2>&1 && echo '✅ Docker is ready' || (echo 'Waiting for Docker...' && timeout=60 && elapsed=0 && until docker info > /dev/null 2>&1; do if [ $elapsed -ge $timeout ]; then echo '❌ Docker failed to start'; exit 1; fi; sleep 2; elapsed=$((elapsed + 2)); done && echo '✅ Docker is ready'))"
      },
      "osx": {
        "command": "echo 'Checking Docker...' && (docker info > /dev/null 2>&1 || (echo 'Starting Docker Desktop...' && open -a Docker)) && (docker info > /dev/null 2>&1 && echo '✅ Docker is ready' || (echo 'Waiting for Docker...' && timeout=60 && elapsed=0 && until docker info > /dev/null 2>&1; do if [ $elapsed -ge $timeout ]; then echo '❌ Docker failed to start'; exit 1; fi; sleep 2; elapsed=$((elapsed + 2)); done && echo '✅ Docker is ready'))"
      },
      "isBackground": true,
      "problemMatcher": {
        "owner": "docker",
        "pattern": {
          "regexp": "^$",
          "message": 1
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^Checking Docker...$",
          "endsPattern": "^✅ Docker is ready$"
        }
      },
      "presentation": {
        "echo": false,
        "clear": true,
        "panel": "shared"
      }
    }
  ]
}
